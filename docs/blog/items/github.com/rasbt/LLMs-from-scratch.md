# 原始URL: https://github.com/rasbt/LLMs-from-scratch

# 抓取时间: 2025-03-30 21:17:38

[Skip to content](https://github.com/rasbt/LLMs-from-scratch#start-of-content)
## Navigation Menu
Toggle navigation
[ ](https://github.com/)
[ Sign in ](https://github.com/login?return_to=https%3A%2F%2Fgithub.com%2Frasbt%2FLLMs-from-scratch)
  * Product 
    * [ GitHub Copilot Write better code with AI  ](https://github.com/features/copilot)
    * [ Security Find and fix vulnerabilities  ](https://github.com/features/security)
    * [ Actions Automate any workflow  ](https://github.com/features/actions)
    * [ Codespaces Instant dev environments  ](https://github.com/features/codespaces)
    * [ Issues Plan and track work  ](https://github.com/features/issues)
    * [ Code Review Manage code changes  ](https://github.com/features/code-review)
    * [ Discussions Collaborate outside of code  ](https://github.com/features/discussions)
    * [ Code Search Find more, search less  ](https://github.com/features/code-search)
Explore
    * [ All features ](https://github.com/features)
    * [ Documentation ](https://docs.github.com)
    * [ GitHub Skills ](https://skills.github.com)
    * [ Blog ](https://github.blog)
  * Solutions 
By company size
    * [ Enterprises ](https://github.com/enterprise)
    * [ Small and medium teams ](https://github.com/team)
    * [ Startups ](https://github.com/enterprise/startups)
    * [ Nonprofits ](https://github.com/solutions/industry/nonprofits)
By use case
    * [ DevSecOps ](https://github.com/solutions/use-case/devsecops)
    * [ DevOps ](https://github.com/solutions/use-case/devops)
    * [ CI/CD ](https://github.com/solutions/use-case/ci-cd)
    * [ View all use cases ](https://github.com/solutions/use-case)
By industry
    * [ Healthcare ](https://github.com/solutions/industry/healthcare)
    * [ Financial services ](https://github.com/solutions/industry/financial-services)
    * [ Manufacturing ](https://github.com/solutions/industry/manufacturing)
    * [ Government ](https://github.com/solutions/industry/government)
    * [ View all industries ](https://github.com/solutions/industry)
[ View all solutions ](https://github.com/solutions)
  * Resources 
Topics
    * [ AI ](https://github.com/resources/articles/ai)
    * [ DevOps ](https://github.com/resources/articles/devops)
    * [ Security ](https://github.com/resources/articles/security)
    * [ Software Development ](https://github.com/resources/articles/software-development)
    * [ View all ](https://github.com/resources/articles)
Explore
    * [ Learning Pathways ](https://resources.github.com/learn/pathways)
    * [ Events & Webinars ](https://resources.github.com)
    * [ Ebooks & Whitepapers ](https://github.com/resources/whitepapers)
    * [ Customer Stories ](https://github.com/customer-stories)
    * [ Partners ](https://partner.github.com)
    * [ Executive Insights ](https://github.com/solutions/executive-insights)
  * Open Source 
    * [ GitHub Sponsors Fund open source developers  ](https://github.com/sponsors)
    * [ The ReadME Project GitHub community articles  ](https://github.com/readme)
Repositories
    * [ Topics ](https://github.com/topics)
    * [ Trending ](https://github.com/trending)
    * [ Collections ](https://github.com/collections)
  * Enterprise 
    * [ Enterprise platform AI-powered developer platform  ](https://github.com/enterprise)
Available add-ons
    * [ Advanced Security Enterprise-grade security features  ](https://github.com/enterprise/advanced-security)
    * [ Copilot for business Enterprise-grade AI features  ](https://github.com/features/copilot/copilot-business)
    * [ Premium Support Enterprise-grade 24/7 support  ](https://github.com/premium-support)
  * [Pricing](https://github.com/pricing)


Search or jump to...
# Search code, repositories, users, issues, pull requests...
Search 
Clear
[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)
#  Provide feedback 
We read every piece of feedback, and take your input very seriously.
Include my email address so I can be contacted
Cancel  Submit feedback 
#  Saved searches 
## Use saved searches to filter your results more quickly
Name
Query
To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax). 
Cancel  Create saved search 
[ Sign in ](https://github.com/login?return_to=https%3A%2F%2Fgithub.com%2Frasbt%2FLLMs-from-scratch)
[ Sign up ](https://github.com/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=rasbt%2FLLMs-from-scratch) Reseting focus
You signed in with another tab or window. [Reload](https://github.com/rasbt/LLMs-from-scratch) to refresh your session. You signed out in another tab or window. [Reload](https://github.com/rasbt/LLMs-from-scratch) to refresh your session. You switched accounts on another tab or window. [Reload](https://github.com/rasbt/LLMs-from-scratch) to refresh your session. Dismiss alert
{{ message }}
[ rasbt ](https://github.com/rasbt) / **[LLMs-from-scratch](https://github.com/rasbt/LLMs-from-scratch) ** Public
  * [ Notifications ](https://github.com/login?return_to=%2Frasbt%2FLLMs-from-scratch) You must be signed in to change notification settings
  * [ Fork 6k ](https://github.com/login?return_to=%2Frasbt%2FLLMs-from-scratch)
  * [ Star  43.3k ](https://github.com/login?return_to=%2Frasbt%2FLLMs-from-scratch)


Implement a ChatGPT-like LLM in PyTorch from scratch, step by step 
[amzn.to/4fqvn0D](https://amzn.to/4fqvn0D "https://amzn.to/4fqvn0D")
### License
[ View license ](https://github.com/rasbt/LLMs-from-scratch/blob/main/LICENSE.txt)
[ 43.3k stars ](https://github.com/rasbt/LLMs-from-scratch/stargazers) [ 6k forks ](https://github.com/rasbt/LLMs-from-scratch/forks) [ Branches ](https://github.com/rasbt/LLMs-from-scratch/branches) [ Tags ](https://github.com/rasbt/LLMs-from-scratch/tags) [ Activity ](https://github.com/rasbt/LLMs-from-scratch/activity)
[ Star  ](https://github.com/login?return_to=%2Frasbt%2FLLMs-from-scratch)
[ Notifications ](https://github.com/login?return_to=%2Frasbt%2FLLMs-from-scratch) You must be signed in to change notification settings
  * [ Code ](https://github.com/rasbt/LLMs-from-scratch)
  * [ Issues 1 ](https://github.com/rasbt/LLMs-from-scratch/issues)
  * [ Pull requests 1 ](https://github.com/rasbt/LLMs-from-scratch/pulls)
  * [ Discussions ](https://github.com/rasbt/LLMs-from-scratch/discussions)
  * [ Actions ](https://github.com/rasbt/LLMs-from-scratch/actions)
  * [ Security ](https://github.com/rasbt/LLMs-from-scratch/security)
  * [ Insights ](https://github.com/rasbt/LLMs-from-scratch/pulse)


Additional navigation options
  * [ Code  ](https://github.com/rasbt/LLMs-from-scratch)
  * [ Issues  ](https://github.com/rasbt/LLMs-from-scratch/issues)
  * [ Pull requests  ](https://github.com/rasbt/LLMs-from-scratch/pulls)
  * [ Discussions  ](https://github.com/rasbt/LLMs-from-scratch/discussions)
  * [ Actions  ](https://github.com/rasbt/LLMs-from-scratch/actions)
  * [ Security  ](https://github.com/rasbt/LLMs-from-scratch/security)
  * [ Insights  ](https://github.com/rasbt/LLMs-from-scratch/pulse)


# rasbt/LLMs-from-scratch
main
[Branches](https://github.com/rasbt/LLMs-from-scratch/branches)[Tags](https://github.com/rasbt/LLMs-from-scratch/tags)
[](https://github.com/rasbt/LLMs-from-scratch/branches)[](https://github.com/rasbt/LLMs-from-scratch/tags)
Go to file
Code
## Folders and files
Name| Name| Last commit message| Last commit date  
---|---|---|---  
## Latest commit
## History
[834 Commits](https://github.com/rasbt/LLMs-from-scratch/commits/main/)[](https://github.com/rasbt/LLMs-from-scratch/commits/main/)  
[.github](https://github.com/rasbt/LLMs-from-scratch/tree/main/.github ".github")| [.github](https://github.com/rasbt/LLMs-from-scratch/tree/main/.github ".github")  
[appendix-A](https://github.com/rasbt/LLMs-from-scratch/tree/main/appendix-A "appendix-A")| [appendix-A](https://github.com/rasbt/LLMs-from-scratch/tree/main/appendix-A "appendix-A")  
[appendix-D](https://github.com/rasbt/LLMs-from-scratch/tree/main/appendix-D "appendix-D")| [appendix-D](https://github.com/rasbt/LLMs-from-scratch/tree/main/appendix-D "appendix-D")  
[appendix-E](https://github.com/rasbt/LLMs-from-scratch/tree/main/appendix-E "appendix-E")| [appendix-E](https://github.com/rasbt/LLMs-from-scratch/tree/main/appendix-E "appendix-E")  
[ch01](https://github.com/rasbt/LLMs-from-scratch/tree/main/ch01 "ch01")| [ch01](https://github.com/rasbt/LLMs-from-scratch/tree/main/ch01 "ch01")  
[ch02](https://github.com/rasbt/LLMs-from-scratch/tree/main/ch02 "ch02")| [ch02](https://github.com/rasbt/LLMs-from-scratch/tree/main/ch02 "ch02")  
[ch03](https://github.com/rasbt/LLMs-from-scratch/tree/main/ch03 "ch03")| [ch03](https://github.com/rasbt/LLMs-from-scratch/tree/main/ch03 "ch03")  
[ch04](https://github.com/rasbt/LLMs-from-scratch/tree/main/ch04 "ch04")| [ch04](https://github.com/rasbt/LLMs-from-scratch/tree/main/ch04 "ch04")  
[ch05](https://github.com/rasbt/LLMs-from-scratch/tree/main/ch05 "ch05")| [ch05](https://github.com/rasbt/LLMs-from-scratch/tree/main/ch05 "ch05")  
[ch06](https://github.com/rasbt/LLMs-from-scratch/tree/main/ch06 "ch06")| [ch06](https://github.com/rasbt/LLMs-from-scratch/tree/main/ch06 "ch06")  
[ch07](https://github.com/rasbt/LLMs-from-scratch/tree/main/ch07 "ch07")| [ch07](https://github.com/rasbt/LLMs-from-scratch/tree/main/ch07 "ch07")  
[pkg/llms_from_scratch](https://github.com/rasbt/LLMs-from-scratch/tree/main/pkg/llms_from_scratch "This path skips through empty directories")| [pkg/llms_from_scratch](https://github.com/rasbt/LLMs-from-scratch/tree/main/pkg/llms_from_scratch "This path skips through empty directories")  
[setup](https://github.com/rasbt/LLMs-from-scratch/tree/main/setup "setup")| [setup](https://github.com/rasbt/LLMs-from-scratch/tree/main/setup "setup")  
[.gitignore](https://github.com/rasbt/LLMs-from-scratch/blob/main/.gitignore ".gitignore")| [.gitignore](https://github.com/rasbt/LLMs-from-scratch/blob/main/.gitignore ".gitignore")  
[CITATION.cff](https://github.com/rasbt/LLMs-from-scratch/blob/main/CITATION.cff "CITATION.cff")| [CITATION.cff](https://github.com/rasbt/LLMs-from-scratch/blob/main/CITATION.cff "CITATION.cff")  
[LICENSE.txt](https://github.com/rasbt/LLMs-from-scratch/blob/main/LICENSE.txt "LICENSE.txt")| [LICENSE.txt](https://github.com/rasbt/LLMs-from-scratch/blob/main/LICENSE.txt "LICENSE.txt")  
[README.md](https://github.com/rasbt/LLMs-from-scratch/blob/main/README.md "README.md")| [README.md](https://github.com/rasbt/LLMs-from-scratch/blob/main/README.md "README.md")  
[pixi.toml](https://github.com/rasbt/LLMs-from-scratch/blob/main/pixi.toml "pixi.toml")| [pixi.toml](https://github.com/rasbt/LLMs-from-scratch/blob/main/pixi.toml "pixi.toml")  
[pyproject.toml](https://github.com/rasbt/LLMs-from-scratch/blob/main/pyproject.toml "pyproject.toml")| [pyproject.toml](https://github.com/rasbt/LLMs-from-scratch/blob/main/pyproject.toml "pyproject.toml")  
[requirements.txt](https://github.com/rasbt/LLMs-from-scratch/blob/main/requirements.txt "requirements.txt")| [requirements.txt](https://github.com/rasbt/LLMs-from-scratch/blob/main/requirements.txt "requirements.txt")  
View all files  
## Repository files navigation
  * [README](https://github.com/rasbt/LLMs-from-scratch)
  * [License](https://github.com/rasbt/LLMs-from-scratch)


# Build a Large Language Model (From Scratch)
[](https://github.com/rasbt/LLMs-from-scratch#build-a-large-language-model-from-scratch)
This repository contains the code for developing, pretraining, and finetuning a GPT-like LLM and is the official code repository for the book [Build a Large Language Model (From Scratch)](https://amzn.to/4fqvn0D).
[![](https://camo.githubusercontent.com/54a738f9f8e7a0d8660d69a63af04c1f74b7c3059c349c78c29e545422ea73ad/68747470733a2f2f73656261737469616e72617363686b612e636f6d2f696d616765732f4c4c4d732d66726f6d2d736372617463682d696d616765732f636f7665722e6a70673f313233)](https://amzn.to/4fqvn0D)
In [_Build a Large Language Model (From Scratch)_](http://mng.bz/orYv), you'll learn and understand how large language models (LLMs) work from the inside out by coding them from the ground up, step by step. In this book, I'll guide you through creating your own LLM, explaining each stage with clear text, diagrams, and examples.
The method described in this book for training and developing your own small-but-functional model for educational purposes mirrors the approach used in creating large-scale foundational models such as those behind ChatGPT. In addition, this book includes code for loading the weights of larger pretrained models for finetuning.
  * Link to the official [source code repository](https://github.com/rasbt/LLMs-from-scratch)
  * [Link to the book at Manning (the publisher's website)](http://mng.bz/orYv)
  * [Link to the book page on Amazon.com](https://www.amazon.com/gp/product/1633437167)
  * ISBN 9781633437166


[![](https://camo.githubusercontent.com/05e9087010fa9e48783ed3a318c21229f85cc224ead7110342b7dc438d5b5948/68747470733a2f2f73656261737469616e72617363686b612e636f6d2f2f696d616765732f4c4c4d732d66726f6d2d736372617463682d696d616765732f6f746865722f726576696577732e706e67)](http://mng.bz/orYv#reviews)
To download a copy of this repository, click on the [Download ZIP](https://github.com/rasbt/LLMs-from-scratch/archive/refs/heads/main.zip) button or execute the following command in your terminal:
```
git clone --depth 1 https://github.com/rasbt/LLMs-from-scratch.git
```

(If you downloaded the code bundle from the Manning website, please consider visiting the official code repository on GitHub at <https://github.com/rasbt/LLMs-from-scratch> for the latest updates.)
# Table of Contents
[](https://github.com/rasbt/LLMs-from-scratch#table-of-contents)
Please note that this `README.md` file is a Markdown (`.md`) file. If you have downloaded this code bundle from the Manning website and are viewing it on your local computer, I recommend using a Markdown editor or previewer for proper viewing. If you haven't installed a Markdown editor yet, [MarkText](https://www.marktext.cc) is a good free option.
You can alternatively view this and other files on GitHub at <https://github.com/rasbt/LLMs-from-scratch> in your browser, which renders Markdown automatically.
> **Tip:** If you're seeking guidance on installing Python and Python packages and setting up your code environment, I suggest reading the [README.md](https://github.com/rasbt/LLMs-from-scratch/blob/main/setup/README.md) file located in the [setup](https://github.com/rasbt/LLMs-from-scratch/blob/main/setup) directory.
[![Code tests Linux](https://github.com/rasbt/LLMs-from-scratch/actions/workflows/basic-tests-linux-uv.yml/badge.svg)](https://github.com/rasbt/LLMs-from-scratch/actions/workflows/basic-tests-linux-uv.yml) [![Code tests Windows](https://github.com/rasbt/LLMs-from-scratch/actions/workflows/basic-tests-windows-uv-pip.yml/badge.svg)](https://github.com/rasbt/LLMs-from-scratch/actions/workflows/basic-tests-windows-uv-pip.yml) [![Code tests macOS](https://github.com/rasbt/LLMs-from-scratch/actions/workflows/basic-tests-macos-uv.yml/badge.svg)](https://github.com/rasbt/LLMs-from-scratch/actions/workflows/basic-tests-macos-uv.yml)
Chapter Title | Main Code (for Quick Access) | All Code + Supplementary  
---|---|---  
[Setup recommendations](https://github.com/rasbt/LLMs-from-scratch/blob/main/setup) | - | -  
Ch 1: Understanding Large Language Models | No code | -  
Ch 2: Working with Text Data | - [ch02.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch02/01_main-chapter-code/ch02.ipynb)- [dataloader.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch02/01_main-chapter-code/dataloader.ipynb) (summary)- [exercise-solutions.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch02/01_main-chapter-code/exercise-solutions.ipynb) | [./ch02](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch02)  
Ch 3: Coding Attention Mechanisms | - [ch03.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch03/01_main-chapter-code/ch03.ipynb)- [multihead-attention.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch03/01_main-chapter-code/multihead-attention.ipynb) (summary) - [exercise-solutions.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch03/01_main-chapter-code/exercise-solutions.ipynb) | [./ch03](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch03)  
Ch 4: Implementing a GPT Model from Scratch | - [ch04.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch04/01_main-chapter-code/ch04.ipynb)- [gpt.py](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch04/01_main-chapter-code/gpt.py) (summary)- [exercise-solutions.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch04/01_main-chapter-code/exercise-solutions.ipynb) | [./ch04](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch04)  
Ch 5: Pretraining on Unlabeled Data | - [ch05.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch05/01_main-chapter-code/ch05.ipynb)- [gpt_train.py](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch05/01_main-chapter-code/gpt_train.py) (summary) - [gpt_generate.py](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch05/01_main-chapter-code/gpt_generate.py) (summary) - [exercise-solutions.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch05/01_main-chapter-code/exercise-solutions.ipynb) | [./ch05](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch05)  
Ch 6: Finetuning for Text Classification | - [ch06.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch06/01_main-chapter-code/ch06.ipynb) - [gpt_class_finetune.py](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch06/01_main-chapter-code/gpt_class_finetune.py) - [exercise-solutions.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch06/01_main-chapter-code/exercise-solutions.ipynb) | [./ch06](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch06)  
Ch 7: Finetuning to Follow Instructions | - [ch07.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch07/01_main-chapter-code/ch07.ipynb)- [gpt_instruction_finetuning.py](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch07/01_main-chapter-code/gpt_instruction_finetuning.py) (summary)- [ollama_evaluate.py](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch07/01_main-chapter-code/ollama_evaluate.py) (summary)- [exercise-solutions.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch07/01_main-chapter-code/exercise-solutions.ipynb) | [./ch07](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch07)  
Appendix A: Introduction to PyTorch | - [code-part1.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/appendix-A/01_main-chapter-code/code-part1.ipynb)- [code-part2.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/appendix-A/01_main-chapter-code/code-part2.ipynb)- [DDP-script.py](https://github.com/rasbt/LLMs-from-scratch/blob/main/appendix-A/01_main-chapter-code/DDP-script.py)- [exercise-solutions.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/appendix-A/01_main-chapter-code/exercise-solutions.ipynb) | [./appendix-A](https://github.com/rasbt/LLMs-from-scratch/blob/main/appendix-A)  
Appendix B: References and Further Reading | No code | -  
Appendix C: Exercise Solutions | No code | -  
Appendix D: Adding Bells and Whistles to the Training Loop | - [appendix-D.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/appendix-D/01_main-chapter-code/appendix-D.ipynb) | [./appendix-D](https://github.com/rasbt/LLMs-from-scratch/blob/main/appendix-D)  
Appendix E: Parameter-efficient Finetuning with LoRA | - [appendix-E.ipynb](https://github.com/rasbt/LLMs-from-scratch/blob/main/appendix-E/01_main-chapter-code/appendix-E.ipynb) | [./appendix-E](https://github.com/rasbt/LLMs-from-scratch/blob/main/appendix-E)  
The mental model below summarizes the contents covered in this book.
[![](https://camo.githubusercontent.com/a17472f25db0af2e7a72700cf3e994b48a61405931b54111ed4d62cbe0371216/68747470733a2f2f73656261737469616e72617363686b612e636f6d2f696d616765732f4c4c4d732d66726f6d2d736372617463682d696d616765732f6d656e74616c2d6d6f64656c2e6a7067)](https://camo.githubusercontent.com/a17472f25db0af2e7a72700cf3e994b48a61405931b54111ed4d62cbe0371216/68747470733a2f2f73656261737469616e72617363686b612e636f6d2f696d616765732f4c4c4d732d66726f6d2d736372617463682d696d616765732f6d656e74616c2d6d6f64656c2e6a7067)
## Hardware Requirements
[](https://github.com/rasbt/LLMs-from-scratch#hardware-requirements)
The code in the main chapters of this book is designed to run on conventional laptops within a reasonable timeframe and does not require specialized hardware. This approach ensures that a wide audience can engage with the material. Additionally, the code automatically utilizes GPUs if they are available. (Please see the [setup](https://github.com/rasbt/LLMs-from-scratch/blob/main/setup/README.md) doc for additional recommendations.)
## Bonus Material
[](https://github.com/rasbt/LLMs-from-scratch#bonus-material)
Several folders contain optional materials as a bonus for interested readers:
  * **Setup**
    * [Python Setup Tips](https://github.com/rasbt/LLMs-from-scratch/blob/main/setup/01_optional-python-setup-preferences)
    * [Installing Python Packages and Libraries Used In This Book](https://github.com/rasbt/LLMs-from-scratch/blob/main/setup/02_installing-python-libraries)
    * [Docker Environment Setup Guide](https://github.com/rasbt/LLMs-from-scratch/blob/main/setup/03_optional-docker-environment)
  * **Chapter 2: Working with text data**
    * [Byte Pair Encoding (BPE) Tokenizer From Scratch](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch02/05_bpe-from-scratch/bpe-from-scratch.ipynb)
    * [Comparing Various Byte Pair Encoding (BPE) Implementations](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch02/02_bonus_bytepair-encoder)
    * [Understanding the Difference Between Embedding Layers and Linear Layers](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch02/03_bonus_embedding-vs-matmul)
    * [Dataloader Intuition with Simple Numbers](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch02/04_bonus_dataloader-intuition)
  * **Chapter 3: Coding attention mechanisms**
    * [Comparing Efficient Multi-Head Attention Implementations](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch03/02_bonus_efficient-multihead-attention/mha-implementations.ipynb)
    * [Understanding PyTorch Buffers](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch03/03_understanding-buffers/understanding-buffers.ipynb)
  * **Chapter 4: Implementing a GPT model from scratch**
    * [FLOPS Analysis](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch04/02_performance-analysis/flops-analysis.ipynb)
  * **Chapter 5: Pretraining on unlabeled data:**
    * [Alternative Weight Loading Methods](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch05/02_alternative_weight_loading)
    * [Pretraining GPT on the Project Gutenberg Dataset](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch05/03_bonus_pretraining_on_gutenberg)
    * [Adding Bells and Whistles to the Training Loop](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch05/04_learning_rate_schedulers)
    * [Optimizing Hyperparameters for Pretraining](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch05/05_bonus_hparam_tuning)
    * [Building a User Interface to Interact With the Pretrained LLM](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch05/06_user_interface)
    * [Converting GPT to Llama](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch05/07_gpt_to_llama)
    * [Llama 3.2 From Scratch](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch05/07_gpt_to_llama/standalone-llama32.ipynb)
    * [Memory-efficient Model Weight Loading](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch05/08_memory_efficient_weight_loading/memory-efficient-state-dict.ipynb)
    * [Extending the Tiktoken BPE Tokenizer with New Tokens](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch05/09_extending-tokenizers/extend-tiktoken.ipynb)
    * [PyTorch Performance Tips for Faster LLM Training](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch05/10_llm-training-speed)
  * **Chapter 6: Finetuning for classification**
    * [Additional experiments finetuning different layers and using larger models](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch06/02_bonus_additional-experiments)
    * [Finetuning different models on 50k IMDB movie review dataset](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch06/03_bonus_imdb-classification)
    * [Building a User Interface to Interact With the GPT-based Spam Classifier](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch06/04_user_interface)
  * **Chapter 7: Finetuning to follow instructions**
    * [Dataset Utilities for Finding Near Duplicates and Creating Passive Voice Entries](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch07/02_dataset-utilities)
    * [Evaluating Instruction Responses Using the OpenAI API and Ollama](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch07/03_model-evaluation)
    * [Generating a Dataset for Instruction Finetuning](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch07/05_dataset-generation/llama3-ollama.ipynb)
    * [Improving a Dataset for Instruction Finetuning](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch07/05_dataset-generation/reflection-gpt4.ipynb)
    * [Generating a Preference Dataset with Llama 3.1 70B and Ollama](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch07/04_preference-tuning-with-dpo/create-preference-data-ollama.ipynb)
    * [Direct Preference Optimization (DPO) for LLM Alignment](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch07/04_preference-tuning-with-dpo/dpo-from-scratch.ipynb)
    * [Building a User Interface to Interact With the Instruction Finetuned GPT Model](https://github.com/rasbt/LLMs-from-scratch/blob/main/ch07/06_user_interface)


## Questions, Feedback, and Contributing to This Repository
[](https://github.com/rasbt/LLMs-from-scratch#questions-feedback-and-contributing-to-this-repository)
I welcome all sorts of feedback, best shared via the [Manning Forum](https://livebook.manning.com/forum?product=raschka&page=1) or [GitHub Discussions](https://github.com/rasbt/LLMs-from-scratch/discussions). Likewise, if you have any questions or just want to bounce ideas off others, please don't hesitate to post these in the forum as well.
Please note that since this repository contains the code corresponding to a print book, I currently cannot accept contributions that would extend the contents of the main chapter code, as it would introduce deviations from the physical book. Keeping it consistent helps ensure a smooth experience for everyone.
## Citation
[](https://github.com/rasbt/LLMs-from-scratch#citation)
If you find this book or code useful for your research, please consider citing it.
Chicago-style citation:
> Raschka, Sebastian. _Build A Large Language Model (From Scratch)_. Manning, 2024. ISBN: 978-1633437166.
BibTeX entry:
```
@book{build-llms-from-scratch-book,
 author    = {Sebastian Raschka},
 title    = {Build A Large Language Model (From Scratch)},
 publisher  = {Manning},
 year     = {2024},
 isbn     = {978-1633437166},
 url     = {https://www.manning.com/books/build-a-large-language-model-from-scratch},
 github    = {https://github.com/rasbt/LLMs-from-scratch}
}

```

## About
Implement a ChatGPT-like LLM in PyTorch from scratch, step by step 
[amzn.to/4fqvn0D](https://amzn.to/4fqvn0D "https://amzn.to/4fqvn0D")
### Topics
[ python ](https://github.com/topics/python "Topic: python") [ ai ](https://github.com/topics/ai "Topic: ai") [ pytorch ](https://github.com/topics/pytorch "Topic: pytorch") [ artificial-intelligence ](https://github.com/topics/artificial-intelligence "Topic: artificial-intelligence") [ transformer ](https://github.com/topics/transformer "Topic: transformer") [ gpt ](https://github.com/topics/gpt "Topic: gpt") [ language-model ](https://github.com/topics/language-model "Topic: language-model") [ large-language-models ](https://github.com/topics/large-language-models "Topic: large-language-models") [ llm ](https://github.com/topics/llm "Topic: llm") [ chatgpt ](https://github.com/topics/chatgpt "Topic: chatgpt")
### Resources
[ Readme ](https://github.com/rasbt/LLMs-from-scratch#readme-ov-file)
### License
[ View license ](https://github.com/rasbt/LLMs-from-scratch#License-1-ov-file)
[ Activity](https://github.com/rasbt/LLMs-from-scratch/activity)
### Stars
[ **43.3k** stars](https://github.com/rasbt/LLMs-from-scratch/stargazers)
### Watchers
[ **428** watching](https://github.com/rasbt/LLMs-from-scratch/watchers)
### Forks
[ **6k** forks](https://github.com/rasbt/LLMs-from-scratch/forks)
[ Report repository ](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Frasbt%2FLLMs-from-scratch&report=rasbt+%28user%29)
##  [Contributors 39](https://github.com/rasbt/LLMs-from-scratch/graphs/contributors)
  * [ ![@rasbt](https://avatars.githubusercontent.com/u/5618407?s=64&v=4) ](https://github.com/rasbt)
  * [ ![@d-kleine](https://avatars.githubusercontent.com/u/53251018?s=64&v=4) ](https://github.com/d-kleine)
  * [ ![@Intelligence-Manifesto](https://avatars.githubusercontent.com/u/155522535?s=64&v=4) ](https://github.com/Intelligence-Manifesto)
  * [ ![@rayed-therap](https://avatars.githubusercontent.com/u/4649183?s=64&v=4) ](https://github.com/rayed-therap)
  * [ ![@TITC](https://avatars.githubusercontent.com/u/35098797?s=64&v=4) ](https://github.com/TITC)
  * [ ![@Shuyib](https://avatars.githubusercontent.com/u/12908522?s=64&v=4) ](https://github.com/Shuyib)
  * [ ![@eltociear](https://avatars.githubusercontent.com/u/22633385?s=64&v=4) ](https://github.com/eltociear)
  * [ ![@pitmonticone](https://avatars.githubusercontent.com/u/38562595?s=64&v=4) ](https://github.com/pitmonticone)
  * [ ![@xiaotian0328](https://avatars.githubusercontent.com/u/44010854?s=64&v=4) ](https://github.com/xiaotian0328)
  * [ ![@jingedawang](https://avatars.githubusercontent.com/u/7996256?s=64&v=4) ](https://github.com/jingedawang)
  * [ ![@hammer](https://avatars.githubusercontent.com/u/15233?s=64&v=4) ](https://github.com/hammer)
  * [ ![@BioGeek](https://avatars.githubusercontent.com/u/59344?s=64&v=4) ](https://github.com/BioGeek)
  * [ ![@shenxiangzhuang](https://avatars.githubusercontent.com/u/17157965?s=64&v=4) ](https://github.com/shenxiangzhuang)
  * [ ![@imkasen](https://avatars.githubusercontent.com/u/18170166?s=64&v=4) ](https://github.com/imkasen)


[+ 25 contributors](https://github.com/rasbt/LLMs-from-scratch/graphs/contributors)
## Languages
  * [ Jupyter Notebook 81.0% ](https://github.com/rasbt/LLMs-from-scratch/search?l=jupyter-notebook)
  * [ Python 19.0% ](https://github.com/rasbt/LLMs-from-scratch/search?l=python)


## Footer
[ ](https://github.com "GitHub") © 2025 GitHub, Inc. 
### Footer navigation
  * [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
  * [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
  * [Security](https://github.com/security)
  * [Status](https://www.githubstatus.com/)
  * [Docs](https://docs.github.com/)
  * [Contact](https://support.github.com?tags=dotcom-footer)
  * Manage cookies 
  * Do not share my personal information 


You can’t perform that action at this time. 
